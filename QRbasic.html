<!DOCTYPE html>
<html>
<head>

<title>QRstyle</title>
<meta http-equiv="Content-Type">
      <meta content="text/html; charset=utf-8"> 
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes" />
      <meta name="format-detection" content="telephone=no">
      <meta name="format-detection" content="email=no">
      <meta name="msapplication-tap-highlight" content="no" />
      <link rel="stylesheet" href="https://weui.io/weui.css">
      
</head>
<body>
<script src="js/lib/jquery-3.1.0.min.js"></script>


<script type="text/javascript" src="js/lib/jquery.qrcode.min.js"></script>
<div class="container" id="container">
	<div class="cell">

		<div class="weui_cells_title">输入文字</div>
		<div class="weui_cells weui_cells_form">
		        <div class="weui_cell">
		            <div class="weui_cell_bd weui_cell_primary">
		                <textarea class="weui_textarea" placeholder="请输入" rows="3"></textarea>
		                <div class="weui_textarea_counter"><span>0</span>/200</div>
		            </div>
		        </div>
		    </div>

		</div></div>
		<a href="javascript:tranQR();" class="weui_btn weui_btn_plain_primary">生成</a>
		<div id="qrcodeCanvas" style="text-align: center;margin-top: 44px;"></div>
<script>
function tranQR(){
	var content= $('textarea').val();

		//jQuery('#qrcode').qrcode("this plugin is great");

		$('#qrcodeCanvas').qrcode({
			width:200,
			height:200,
			correctLevel:0,
			text:utf16to8(content)
		});

};
function utf16to8(str) {  
    var out, i, len, c;  
    out = "";  
    len = str.length;  
    for(i = 0; i < len; i++) {  
    c = str.charCodeAt(i);  
    if ((c >= 0x0001) && (c <= 0x007F)) {  
        out += str.charAt(i);  
    } else if (c > 0x07FF) {  
        out += String.fromCharCode(0xE0 | ((c >> 12) & 0x0F));  
        out += String.fromCharCode(0x80 | ((c >>  6) & 0x3F));  
        out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));  
    } else {  
        out += String.fromCharCode(0xC0 | ((c >>  6) & 0x1F));  
        out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));  
    }  
    }  
    return out;  
}  



/*

	var ca=$('#qrcodeCanvas canvas').get(0);
var ctx = ca.getContext('2d');
ctx.arc(100,100,50,0,Math.PI*2);
ctx.fillStyle = "rgba(234,1,1,0.6)";
ctx.fill();
ctx.beginPath();
ctx.fillStyle = 'rgba(1,234,1,0.7)';
ctx.fillRect(100,100,70,100);
ca.onclick = function  (e) {
	var x = e.clientX,
		y = e.clientY,
		caL = ca.getBoundingClientRect().left,
		caT = ca.getBoundingClientRect().top;
	var X = x-caL, Y = y-caT;
	// console.log('X:'+X+',Y:'+Y);
	var imagedata = ctx.getImageData(X,Y,10,10);
	for(var i=0,dl = imagedata.data.length;i
<dl;i+=4) {
		imagedata.data[i] = 255-imagedata.data[i];
		imagedata.data[i+1] = 255-imagedata.data[i];
		imagedata.data[i+2] = 255-imagedata.data[i];
	}
	ctx.putImageData(imagedata,X,Y);
	// jg.innerHTML = data.data;
	console.log(imagedata);
}
	*/
</script>

</body>
</html>
